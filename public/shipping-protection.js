var lu=Object.defineProperty;var fu=(_,y,E)=>y in _?lu(_,y,{enumerable:!0,configurable:!0,writable:!0,value:E}):_[y]=E;var O=(_,y,E)=>fu(_,typeof y!="symbol"?y+"":y,E);(function(_){"use strict";var zt;function y(e){return{ok:!0,value:e}}function E(e){return{ok:!1,error:e}}function Y(e){return e.ok}function yt(e){return!e.ok}function Et(e,t){return Y(e)?y(t(e.value)):e}function Zt(e,t){return Y(e)?t(e.value):e}function $t(e,t){return Y(e)?e.value:t}function It(e){try{return y(JSON.parse(e))}catch(t){return E(t instanceof Error?t:new Error("Failed to parse JSON"))}}function Rt(e){try{return y(JSON.stringify(e))}catch(t){return E(t instanceof Error?t:new Error("Failed to stringify JSON"))}}const le={API_CALL:5e3,INIT:1e4,BATCH_FLUSH:2e3};async function Ot(e,t={}){const{timeoutMs:n=le.API_CALL,signal:r,...o}=t,i=new AbortController,u=setTimeout(()=>i.abort(),n);try{const s=await fetch(e,{...o,signal:St(r,i.signal)});return y(s)}catch(s){return E(s instanceof Error?s:new Error("Network error"))}finally{clearTimeout(u)}}function St(e,t){if(!e)return t;if(!t)return e;const n=new AbortController,r=()=>n.abort(e.reason),o=()=>n.abort(t.reason);return e.addEventListener("abort",r,{once:!0}),t.addEventListener("abort",o,{once:!0}),e.aborted&&n.abort(e.reason),t.aborted&&n.abort(t.reason),n.signal}function fe(e){try{return typeof window=="undefined"?null:e==="local"?window.localStorage:window.sessionStorage}catch{return null}}function Tt(e,t="local"){const n=fe(t);if(!n)return null;try{return n.getItem(e)}catch{return null}}function At(e,t,n="local"){const r=fe(n);if(!r)return!1;try{return r.setItem(e,t),!0}catch{return!1}}function Pt(e,t="local"){const n=fe(t);if(!n)return!1;try{return n.removeItem(e),!0}catch{return!1}}class Nt{constructor(){O(this,"listeners",new Map)}on(t,n){this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t).add(n)}off(t,n){var r;(r=this.listeners.get(t))==null||r.delete(n)}emit(t,n={}){var o;const r=new CustomEvent(t,{detail:n});(o=this.listeners.get(t))==null||o.forEach(i=>i(r)),window.dispatchEvent(r)}}function Ct(e,t){switch(e){case"UNINITIALIZED":return t.type==="INITIALIZE"?"INITIALIZING":e;case"INITIALIZING":return t.type==="READY"?"READY":t.type==="ERROR"?"ERROR":e;case"READY":return t.type==="CALCULATE_QUOTE"?"CALCULATING":t.type==="ERROR"?"ERROR":e;case"CALCULATING":return t.type==="QUOTE_READY"?"QUOTE_AVAILABLE":t.type==="ERROR"?"ERROR":e;case"QUOTE_AVAILABLE":return t.type==="SELECT_PROTECTION"||t.type==="DECLINE_PROTECTION"?"READY":t.type==="ERROR"?"ERROR":e;case"ERROR":return t.type==="DESTROY"?"DESTROYED":e;case"DESTROYED":return"DESTROYED";default:return e}}function Dt(){return"qa"}const jt=Dt(),Ut={qa:"https://edge-compute-f.dp.domain-ship.qa20.narvar.qa",st:"https://edge-compute-f.dp.domain-ship.st20.narvar.qa",prod:"https://edge-compute-f.dp.domain-ship.narvar.com"};function Ft(e=jt){const t=Ut[e];return{QUOTE:`${t}/v1/quote`,VERIFY:`${t}/v1/verify`,CONFIG:n=>`${t}/v1/config/${n}`,JWKS:`${t}/.well-known/jwks.json`,HEALTH:`${t}/health`}}function $(e,t,n,r=!1){return{category:e,message:t,cause:n,retryable:r}}class Lt{constructor(t){this.config=t}calculate(t){var u,s,c,l,h,m,f;const{pricing:n}=this.config,r=t.subtotal+((u=t.fees)!=null?u:0)-((s=t.discounts)!=null?s:0);if(n.tiers&&n.tiers.length>0){const p=[...n.tiers].sort((U,$e)=>U.threshold-$e.threshold),b=(c=p.find(U=>r>=U.threshold))!=null?c:p[p.length-1],R=(l=b==null?void 0:b.percentage)!=null?l:0,j=(h=b==null?void 0:b.fixedFee)!=null?h:0;return{amount:Ie(r*(R/100)+j),currency:t.currency}}const o=(m=n.percentage)!=null?m:0,i=(f=n.fixedFee)!=null?f:0;return{amount:Ie(r*(o/100)+i),currency:t.currency}}async calculateWithEdge(t,n){var r,o;try{const i=(r=n.environment)!=null?r:"qa",u=Ft(i),s={currency:t.currency,locale:n.locale,order_items:t.items.map(m=>({line_price:Math.round(m.price*100),quantity:m.quantity,sku:m.sku,total_tax:0})),ship_to:n.region.toUpperCase(),shipping_fee:Math.round(((o=t.fees)!=null?o:0)*100),shipping_fee_tax:0,store_id:n.retailerMoniker},c=await fetch(u.QUOTE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!c.ok)return E($("NETWORK_ERROR",`Edge API returned ${c.status}`,await c.text()));const l=await c.json(),h={amount:l.quote.premium_value/100,currency:t.currency,eligible:l.eligible==="eligible",signature:l.signature,ineligible_reason:l.ineligible_reason,source:"server"};return y(h)}catch(i){return E($("NETWORK_ERROR","Failed to fetch edge quote",i))}}}function Ie(e){return Math.round(e*100)/100}function a(e,t,n){var s;function r(c,l){if(c._zod||Object.defineProperty(c,"_zod",{value:{def:l,constr:u,traits:new Set},enumerable:!1}),c._zod.traits.has(e))return;c._zod.traits.add(e),t(c,l);const h=u.prototype,m=Object.keys(h);for(let f=0;f<m.length;f++){const p=m[f];p in c||(c[p]=h[p].bind(c))}}const o=(s=n==null?void 0:n.Parent)!=null?s:Object;class i extends o{}Object.defineProperty(i,"name",{value:e});function u(c){var m;var l;const h=n!=null&&n.Parent?new i:this;r(h,c),(m=(l=h._zod).deferred)!=null||(l.deferred=[]);for(const f of h._zod.deferred)f();return h}return Object.defineProperty(u,"init",{value:r}),Object.defineProperty(u,Symbol.hasInstance,{value:c=>{var l,h;return n!=null&&n.Parent&&c instanceof n.Parent?!0:(h=(l=c==null?void 0:c._zod)==null?void 0:l.traits)==null?void 0:h.has(e)}}),Object.defineProperty(u,"name",{value:e}),u}class M extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class Re extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const Oe={};function N(e){return Oe}function xt(e){const t=Object.values(e).filter(r=>typeof r=="number");return Object.entries(e).filter(([r,o])=>t.indexOf(+r)===-1).map(([r,o])=>o)}function he(e,t){return typeof t=="bigint"?t.toString():t}function de(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function pe(e){return e==null}function me(e){const t=e.startsWith("^")?1:0,n=e.endsWith("$")?e.length-1:e.length;return e.slice(t,n)}function Mt(e,t){const n=(e.toString().split(".")[1]||"").length,r=t.toString();let o=(r.split(".")[1]||"").length;if(o===0&&/\d?e-\d?/.test(r)){const c=r.match(/\d?e-(\d?)/);c!=null&&c[1]&&(o=Number.parseInt(c[1]))}const i=n>o?n:o,u=Number.parseInt(e.toFixed(i).replace(".","")),s=Number.parseInt(t.toFixed(i).replace(".",""));return u%s/10**i}const Se=Symbol("evaluating");function g(e,t,n){let r;Object.defineProperty(e,t,{get(){if(r!==Se)return r===void 0&&(r=Se,r=n()),r},set(o){Object.defineProperty(e,t,{value:o})},configurable:!0})}function F(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function L(...e){const t={};for(const n of e){const r=Object.getOwnPropertyDescriptors(n);Object.assign(t,r)}return Object.defineProperties({},t)}function Te(e){return JSON.stringify(e)}function Vt(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const Ae="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function Q(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const qt=de(()=>{var e;if(typeof navigator!="undefined"&&((e=navigator==null?void 0:navigator.userAgent)!=null&&e.includes("Cloudflare")))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function V(e){if(Q(e)===!1)return!1;const t=e.constructor;if(t===void 0||typeof t!="function")return!0;const n=t.prototype;return!(Q(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function Pe(e){return V(e)?{...e}:Array.isArray(e)?[...e]:e}const Gt=new Set(["string","number","symbol"]);function X(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function C(e,t,n){const r=new e._zod.constr(t!=null?t:e._zod.def);return(!t||n!=null&&n.parent)&&(r._zod.parent=e),r}function d(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if((t==null?void 0:t.message)!==void 0){if((t==null?void 0:t.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function Wt(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const Kt={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Bt(e,t){const n=e._zod.def,r=L(e._zod.def,{get shape(){const o={};for(const i in t){if(!(i in n.shape))throw new Error(`Unrecognized key: "${i}"`);t[i]&&(o[i]=n.shape[i])}return F(this,"shape",o),o},checks:[]});return C(e,r)}function Jt(e,t){const n=e._zod.def,r=L(e._zod.def,{get shape(){const o={...e._zod.def.shape};for(const i in t){if(!(i in n.shape))throw new Error(`Unrecognized key: "${i}"`);t[i]&&delete o[i]}return F(this,"shape",o),o},checks:[]});return C(e,r)}function Yt(e,t){if(!V(t))throw new Error("Invalid input to extend: expected a plain object");const n=e._zod.def.checks;if(n&&n.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const o=L(e._zod.def,{get shape(){const i={...e._zod.def.shape,...t};return F(this,"shape",i),i},checks:[]});return C(e,o)}function Qt(e,t){if(!V(t))throw new Error("Invalid input to safeExtend: expected a plain object");const n={...e._zod.def,get shape(){const r={...e._zod.def.shape,...t};return F(this,"shape",r),r},checks:e._zod.def.checks};return C(e,n)}function Xt(e,t){const n=L(e._zod.def,{get shape(){const r={...e._zod.def.shape,...t._zod.def.shape};return F(this,"shape",r),r},get catchall(){return t._zod.def.catchall},checks:[]});return C(e,n)}function Ht(e,t,n){const r=L(t._zod.def,{get shape(){const o=t._zod.def.shape,i={...o};if(n)for(const u in n){if(!(u in o))throw new Error(`Unrecognized key: "${u}"`);n[u]&&(i[u]=e?new e({type:"optional",innerType:o[u]}):o[u])}else for(const u in o)i[u]=e?new e({type:"optional",innerType:o[u]}):o[u];return F(this,"shape",i),i},checks:[]});return C(t,r)}function en(e,t,n){const r=L(t._zod.def,{get shape(){const o=t._zod.def.shape,i={...o};if(n)for(const u in n){if(!(u in i))throw new Error(`Unrecognized key: "${u}"`);n[u]&&(i[u]=new e({type:"nonoptional",innerType:o[u]}))}else for(const u in o)i[u]=new e({type:"nonoptional",innerType:o[u]});return F(this,"shape",i),i},checks:[]});return C(t,r)}function q(e,t=0){var n;if(e.aborted===!0)return!0;for(let r=t;r<e.issues.length;r++)if(((n=e.issues[r])==null?void 0:n.continue)!==!0)return!0;return!1}function G(e,t){return t.map(n=>{var o;var r;return(o=(r=n).path)!=null||(r.path=[]),n.path.unshift(e),n})}function H(e){return typeof e=="string"?e:e==null?void 0:e.message}function D(e,t,n){var o,i,u,s,c,l,h,m,f,p,b;const r={...e,path:(o=e.path)!=null?o:[]};if(!e.message){const R=(b=(p=(m=(l=H((s=(u=(i=e.inst)==null?void 0:i._zod.def)==null?void 0:u.error)==null?void 0:s.call(u,e)))!=null?l:H((c=t==null?void 0:t.error)==null?void 0:c.call(t,e)))!=null?m:H((h=n.customError)==null?void 0:h.call(n,e)))!=null?p:H((f=n.localeError)==null?void 0:f.call(n,e)))!=null?b:"Invalid input";r.message=R}return delete r.inst,delete r.continue,t!=null&&t.reportInput||delete r.input,r}function _e(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function B(...e){const[t,n,r]=e;return typeof t=="string"?{message:t,code:"custom",input:n,inst:r}:{...t}}const Ne=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,he,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Ce=a("$ZodError",Ne),De=a("$ZodError",Ne,{Parent:Error});function tn(e,t=n=>n.message){const n={},r=[];for(const o of e.issues)o.path.length>0?(n[o.path[0]]=n[o.path[0]]||[],n[o.path[0]].push(t(o))):r.push(t(o));return{formErrors:r,fieldErrors:n}}function nn(e,t=n=>n.message){const n={_errors:[]},r=o=>{for(const i of o.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(u=>r({issues:u}));else if(i.code==="invalid_key")r({issues:i.issues});else if(i.code==="invalid_element")r({issues:i.issues});else if(i.path.length===0)n._errors.push(t(i));else{let u=n,s=0;for(;s<i.path.length;){const c=i.path[s];s===i.path.length-1?(u[c]=u[c]||{_errors:[]},u[c]._errors.push(t(i))):u[c]=u[c]||{_errors:[]},u=u[c],s++}}};return r(e),n}const ge=e=>(t,n,r,o)=>{var s;const i=r?Object.assign(r,{async:!1}):{async:!1},u=t._zod.run({value:n,issues:[]},i);if(u instanceof Promise)throw new M;if(u.issues.length){const c=new((s=o==null?void 0:o.Err)!=null?s:e)(u.issues.map(l=>D(l,i,N())));throw Ae(c,o==null?void 0:o.callee),c}return u.value},ve=e=>async(t,n,r,o)=>{var s;const i=r?Object.assign(r,{async:!0}):{async:!0};let u=t._zod.run({value:n,issues:[]},i);if(u instanceof Promise&&(u=await u),u.issues.length){const c=new((s=o==null?void 0:o.Err)!=null?s:e)(u.issues.map(l=>D(l,i,N())));throw Ae(c,o==null?void 0:o.callee),c}return u.value},ee=e=>(t,n,r)=>{const o=r?{...r,async:!1}:{async:!1},i=t._zod.run({value:n,issues:[]},o);if(i instanceof Promise)throw new M;return i.issues.length?{success:!1,error:new(e!=null?e:Ce)(i.issues.map(u=>D(u,o,N())))}:{success:!0,data:i.value}},rn=ee(De),te=e=>async(t,n,r)=>{const o=r?Object.assign(r,{async:!0}):{async:!0};let i=t._zod.run({value:n,issues:[]},o);return i instanceof Promise&&(i=await i),i.issues.length?{success:!1,error:new e(i.issues.map(u=>D(u,o,N())))}:{success:!0,data:i.value}},on=te(De),un=e=>(t,n,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return ge(e)(t,n,o)},cn=e=>(t,n,r)=>ge(e)(t,n,r),sn=e=>async(t,n,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return ve(e)(t,n,o)},an=e=>async(t,n,r)=>ve(e)(t,n,r),ln=e=>(t,n,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return ee(e)(t,n,o)},fn=e=>(t,n,r)=>ee(e)(t,n,r),hn=e=>async(t,n,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return te(e)(t,n,o)},dn=e=>async(t,n,r)=>te(e)(t,n,r),pn=/^[cC][^\s-]{8,}$/,mn=/^[0-9a-z]+$/,_n=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,gn=/^[0-9a-vA-V]{20}$/,vn=/^[A-Za-z0-9]{27}$/,bn=/^[a-zA-Z0-9_-]{21}$/,wn=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,kn=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,je=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,zn=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,yn="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function En(){return new RegExp(yn,"u")}const Zn=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,$n=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,In=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Rn=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,On=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Ue=/^[A-Za-z0-9_-]*$/,Sn=/^\+(?:[0-9]){6,14}[0-9]$/,Fe="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Tn=new RegExp(`^${Fe}$`);function Le(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function An(e){return new RegExp(`^${Le(e)}$`)}function Pn(e){const t=Le({precision:e.precision}),n=["Z"];e.local&&n.push(""),e.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const r=`${t}(?:${n.join("|")})`;return new RegExp(`^${Fe}T(?:${r})$`)}const Nn=e=>{var n,r;const t=e?`[\\s\\S]{${(n=e==null?void 0:e.minimum)!=null?n:0},${(r=e==null?void 0:e.maximum)!=null?r:""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},Cn=/^-?\d+$/,Dn=/^-?\d+(?:\.\d+)?/,jn=/^(?:true|false)$/i,Un=/^[^A-Z]*$/,Fn=/^[^a-z]*$/,Z=a("$ZodCheck",(e,t)=>{var r,o;var n;(r=e._zod)!=null||(e._zod={}),e._zod.def=t,(o=(n=e._zod).onattach)!=null||(n.onattach=[])}),xe={number:"number",bigint:"bigint",object:"date"},Me=a("$ZodCheckLessThan",(e,t)=>{Z.init(e,t);const n=xe[typeof t.value];e._zod.onattach.push(r=>{var u;const o=r._zod.bag,i=(u=t.inclusive?o.maximum:o.exclusiveMaximum)!=null?u:Number.POSITIVE_INFINITY;t.value<i&&(t.inclusive?o.maximum=t.value:o.exclusiveMaximum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value<=t.value:r.value<t.value)||r.issues.push({origin:n,code:"too_big",maximum:t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Ve=a("$ZodCheckGreaterThan",(e,t)=>{Z.init(e,t);const n=xe[typeof t.value];e._zod.onattach.push(r=>{var u;const o=r._zod.bag,i=(u=t.inclusive?o.minimum:o.exclusiveMinimum)!=null?u:Number.NEGATIVE_INFINITY;t.value>i&&(t.inclusive?o.minimum=t.value:o.exclusiveMinimum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value>=t.value:r.value>t.value)||r.issues.push({origin:n,code:"too_small",minimum:t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Ln=a("$ZodCheckMultipleOf",(e,t)=>{Z.init(e,t),e._zod.onattach.push(n=>{var o;var r;(o=(r=n._zod.bag).multipleOf)!=null||(r.multipleOf=t.value)}),e._zod.check=n=>{if(typeof n.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%t.value===BigInt(0):Mt(n.value,t.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:t.value,input:n.value,inst:e,continue:!t.abort})}}),xn=a("$ZodCheckNumberFormat",(e,t)=>{var u;Z.init(e,t),t.format=t.format||"float64";const n=(u=t.format)==null?void 0:u.includes("int"),r=n?"int":"number",[o,i]=Kt[t.format];e._zod.onattach.push(s=>{const c=s._zod.bag;c.format=t.format,c.minimum=o,c.maximum=i,n&&(c.pattern=Cn)}),e._zod.check=s=>{const c=s.value;if(n){if(!Number.isInteger(c)){s.issues.push({expected:r,format:t.format,code:"invalid_type",continue:!1,input:c,inst:e});return}if(!Number.isSafeInteger(c)){c>0?s.issues.push({input:c,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:r,continue:!t.abort}):s.issues.push({input:c,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:r,continue:!t.abort});return}}c<o&&s.issues.push({origin:"number",input:c,code:"too_small",minimum:o,inclusive:!0,inst:e,continue:!t.abort}),c>i&&s.issues.push({origin:"number",input:c,code:"too_big",maximum:i,inst:e})}}),Mn=a("$ZodCheckMaxLength",(e,t)=>{var r;var n;Z.init(e,t),(r=(n=e._zod.def).when)!=null||(n.when=o=>{const i=o.value;return!pe(i)&&i.length!==void 0}),e._zod.onattach.push(o=>{var u;const i=(u=o._zod.bag.maximum)!=null?u:Number.POSITIVE_INFINITY;t.maximum<i&&(o._zod.bag.maximum=t.maximum)}),e._zod.check=o=>{const i=o.value;if(i.length<=t.maximum)return;const s=_e(i);o.issues.push({origin:s,code:"too_big",maximum:t.maximum,inclusive:!0,input:i,inst:e,continue:!t.abort})}}),Vn=a("$ZodCheckMinLength",(e,t)=>{var r;var n;Z.init(e,t),(r=(n=e._zod.def).when)!=null||(n.when=o=>{const i=o.value;return!pe(i)&&i.length!==void 0}),e._zod.onattach.push(o=>{var u;const i=(u=o._zod.bag.minimum)!=null?u:Number.NEGATIVE_INFINITY;t.minimum>i&&(o._zod.bag.minimum=t.minimum)}),e._zod.check=o=>{const i=o.value;if(i.length>=t.minimum)return;const s=_e(i);o.issues.push({origin:s,code:"too_small",minimum:t.minimum,inclusive:!0,input:i,inst:e,continue:!t.abort})}}),qn=a("$ZodCheckLengthEquals",(e,t)=>{var r;var n;Z.init(e,t),(r=(n=e._zod.def).when)!=null||(n.when=o=>{const i=o.value;return!pe(i)&&i.length!==void 0}),e._zod.onattach.push(o=>{const i=o._zod.bag;i.minimum=t.length,i.maximum=t.length,i.length=t.length}),e._zod.check=o=>{const i=o.value,u=i.length;if(u===t.length)return;const s=_e(i),c=u>t.length;o.issues.push({origin:s,...c?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:o.value,inst:e,continue:!t.abort})}}),ne=a("$ZodCheckStringFormat",(e,t)=>{var o,i;var n,r;Z.init(e,t),e._zod.onattach.push(u=>{var c;const s=u._zod.bag;s.format=t.format,t.pattern&&((c=s.patterns)!=null||(s.patterns=new Set),s.patterns.add(t.pattern))}),t.pattern?(o=(n=e._zod).check)!=null||(n.check=u=>{t.pattern.lastIndex=0,!t.pattern.test(u.value)&&u.issues.push({origin:"string",code:"invalid_format",format:t.format,input:u.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(i=(r=e._zod).check)!=null||(r.check=()=>{})}),Gn=a("$ZodCheckRegex",(e,t)=>{ne.init(e,t),e._zod.check=n=>{t.pattern.lastIndex=0,!t.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),Wn=a("$ZodCheckLowerCase",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=Un),ne.init(e,t)}),Kn=a("$ZodCheckUpperCase",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=Fn),ne.init(e,t)}),Bn=a("$ZodCheckIncludes",(e,t)=>{Z.init(e,t);const n=X(t.includes),r=new RegExp(typeof t.position=="number"?`^.{${t.position}}${n}`:n);t.pattern=r,e._zod.onattach.push(o=>{var u;const i=o._zod.bag;(u=i.patterns)!=null||(i.patterns=new Set),i.patterns.add(r)}),e._zod.check=o=>{o.value.includes(t.includes,t.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:o.value,inst:e,continue:!t.abort})}}),Jn=a("$ZodCheckStartsWith",(e,t)=>{var r;Z.init(e,t);const n=new RegExp(`^${X(t.prefix)}.*`);(r=t.pattern)!=null||(t.pattern=n),e._zod.onattach.push(o=>{var u;const i=o._zod.bag;(u=i.patterns)!=null||(i.patterns=new Set),i.patterns.add(n)}),e._zod.check=o=>{o.value.startsWith(t.prefix)||o.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:o.value,inst:e,continue:!t.abort})}}),Yn=a("$ZodCheckEndsWith",(e,t)=>{var r;Z.init(e,t);const n=new RegExp(`.*${X(t.suffix)}$`);(r=t.pattern)!=null||(t.pattern=n),e._zod.onattach.push(o=>{var u;const i=o._zod.bag;(u=i.patterns)!=null||(i.patterns=new Set),i.patterns.add(n)}),e._zod.check=o=>{o.value.endsWith(t.suffix)||o.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:o.value,inst:e,continue:!t.abort})}}),Qn=a("$ZodCheckOverwrite",(e,t)=>{Z.init(e,t),e._zod.check=n=>{n.value=t.tx(n.value)}});class Xn{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const r=t.split(`
`).filter(u=>u),o=Math.min(...r.map(u=>u.length-u.trimStart().length)),i=r.map(u=>u.slice(o)).map(u=>" ".repeat(this.indent*2)+u);for(const u of i)this.content.push(u)}compile(){var i;const t=Function,n=this==null?void 0:this.args,o=[...((i=this==null?void 0:this.content)!=null?i:[""]).map(u=>`  ${u}`)];return new t(...n,o.join(`
`))}}const Hn={major:4,minor:1,patch:13},k=a("$ZodType",(e,t)=>{var o,i,u;var n;e!=null||(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Hn;const r=[...(o=e._zod.def.checks)!=null?o:[]];e._zod.traits.has("$ZodCheck")&&r.unshift(e);for(const s of r)for(const c of s._zod.onattach)c(e);if(r.length===0)(i=(n=e._zod).deferred)!=null||(n.deferred=[]),(u=e._zod.deferred)==null||u.push(()=>{e._zod.run=e._zod.parse});else{const s=(l,h,m)=>{let f=q(l),p;for(const b of h){if(b._zod.def.when){if(!b._zod.def.when(l))continue}else if(f)continue;const R=l.issues.length,j=b._zod.check(l);if(j instanceof Promise&&(m==null?void 0:m.async)===!1)throw new M;if(p||j instanceof Promise)p=(p!=null?p:Promise.resolve()).then(async()=>{await j,l.issues.length!==R&&(f||(f=q(l,R)))});else{if(l.issues.length===R)continue;f||(f=q(l,R))}}return p?p.then(()=>l):l},c=(l,h,m)=>{if(q(l))return l.aborted=!0,l;const f=s(h,r,m);if(f instanceof Promise){if(m.async===!1)throw new M;return f.then(p=>e._zod.parse(p,m))}return e._zod.parse(f,m)};e._zod.run=(l,h)=>{if(h.skipChecks)return e._zod.parse(l,h);if(h.direction==="backward"){const f=e._zod.parse({value:l.value,issues:[]},{...h,skipChecks:!0});return f instanceof Promise?f.then(p=>c(p,l,h)):c(f,l,h)}const m=e._zod.parse(l,h);if(m instanceof Promise){if(h.async===!1)throw new M;return m.then(f=>s(f,r,h))}return s(m,r,h)}}e["~standard"]={validate:s=>{var c;try{const l=rn(e,s);return l.success?{value:l.data}:{issues:(c=l.error)==null?void 0:c.issues}}catch{return on(e,s).then(h=>{var m;return h.success?{value:h.data}:{issues:(m=h.error)==null?void 0:m.issues}})}},vendor:"zod",version:1}}),be=a("$ZodString",(e,t)=>{var n,r,o;k.init(e,t),e._zod.pattern=(o=[...(r=(n=e==null?void 0:e._zod.bag)==null?void 0:n.patterns)!=null?r:[]].pop())!=null?o:Nn(e._zod.bag),e._zod.parse=(i,u)=>{if(t.coerce)try{i.value=String(i.value)}catch{}return typeof i.value=="string"||i.issues.push({expected:"string",code:"invalid_type",input:i.value,inst:e}),i}}),v=a("$ZodStringFormat",(e,t)=>{ne.init(e,t),be.init(e,t)}),er=a("$ZodGUID",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=kn),v.init(e,t)}),tr=a("$ZodUUID",(e,t)=>{var n,r;if(t.version){const i={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(i===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);(n=t.pattern)!=null||(t.pattern=je(i))}else(r=t.pattern)!=null||(t.pattern=je());v.init(e,t)}),nr=a("$ZodEmail",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=zn),v.init(e,t)}),rr=a("$ZodURL",(e,t)=>{v.init(e,t),e._zod.check=n=>{try{const r=n.value.trim(),o=new URL(r);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(o.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:n.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:n.value,inst:e,continue:!t.abort})),t.normalize?n.value=o.href:n.value=r;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:e,continue:!t.abort})}}}),or=a("$ZodEmoji",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=En()),v.init(e,t)}),ir=a("$ZodNanoID",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=bn),v.init(e,t)}),ur=a("$ZodCUID",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=pn),v.init(e,t)}),cr=a("$ZodCUID2",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=mn),v.init(e,t)}),sr=a("$ZodULID",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=_n),v.init(e,t)}),ar=a("$ZodXID",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=gn),v.init(e,t)}),lr=a("$ZodKSUID",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=vn),v.init(e,t)}),fr=a("$ZodISODateTime",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=Pn(t)),v.init(e,t)}),hr=a("$ZodISODate",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=Tn),v.init(e,t)}),dr=a("$ZodISOTime",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=An(t)),v.init(e,t)}),pr=a("$ZodISODuration",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=wn),v.init(e,t)}),mr=a("$ZodIPv4",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=Zn),v.init(e,t),e._zod.bag.format="ipv4"}),_r=a("$ZodIPv6",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=$n),v.init(e,t),e._zod.bag.format="ipv6",e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),gr=a("$ZodCIDRv4",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=In),v.init(e,t)}),vr=a("$ZodCIDRv6",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=Rn),v.init(e,t),e._zod.check=r=>{const o=r.value.split("/");try{if(o.length!==2)throw new Error;const[i,u]=o;if(!u)throw new Error;const s=Number(u);if(`${s}`!==u)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${i}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function qe(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const br=a("$ZodBase64",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=On),v.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=r=>{qe(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function wr(e){if(!Ue.test(e))return!1;const t=e.replace(/[-_]/g,r=>r==="-"?"+":"/"),n=t.padEnd(Math.ceil(t.length/4)*4,"=");return qe(n)}const kr=a("$ZodBase64URL",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=Ue),v.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=r=>{wr(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),zr=a("$ZodE164",(e,t)=>{var n;(n=t.pattern)!=null||(t.pattern=Sn),v.init(e,t)});function yr(e,t=null){try{const n=e.split(".");if(n.length!==3)return!1;const[r]=n;if(!r)return!1;const o=JSON.parse(atob(r));return!("typ"in o&&(o==null?void 0:o.typ)!=="JWT"||!o.alg||t&&(!("alg"in o)||o.alg!==t))}catch{return!1}}const Er=a("$ZodJWT",(e,t)=>{v.init(e,t),e._zod.check=n=>{yr(n.value,t.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:e,continue:!t.abort})}}),Ge=a("$ZodNumber",(e,t)=>{var n;k.init(e,t),e._zod.pattern=(n=e._zod.bag.pattern)!=null?n:Dn,e._zod.parse=(r,o)=>{if(t.coerce)try{r.value=Number(r.value)}catch{}const i=r.value;if(typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i))return r;const u=typeof i=="number"?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:i,inst:e,...u?{received:u}:{}}),r}}),Zr=a("$ZodNumberFormat",(e,t)=>{xn.init(e,t),Ge.init(e,t)}),$r=a("$ZodBoolean",(e,t)=>{k.init(e,t),e._zod.pattern=jn,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=!!n.value}catch{}const o=n.value;return typeof o=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:e}),n}}),Ir=a("$ZodUnknown",(e,t)=>{k.init(e,t),e._zod.parse=n=>n}),Rr=a("$ZodNever",(e,t)=>{k.init(e,t),e._zod.parse=(n,r)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:e}),n)});function We(e,t,n){e.issues.length&&t.issues.push(...G(n,e.issues)),t.value[n]=e.value}const Or=a("$ZodArray",(e,t)=>{k.init(e,t),e._zod.parse=(n,r)=>{const o=n.value;if(!Array.isArray(o))return n.issues.push({expected:"array",code:"invalid_type",input:o,inst:e}),n;n.value=Array(o.length);const i=[];for(let u=0;u<o.length;u++){const s=o[u],c=t.element._zod.run({value:s,issues:[]},r);c instanceof Promise?i.push(c.then(l=>We(l,n,u))):We(c,n,u)}return i.length?Promise.all(i).then(()=>n):n}});function re(e,t,n,r){e.issues.length&&t.issues.push(...G(n,e.issues)),e.value===void 0?n in r&&(t.value[n]=void 0):t.value[n]=e.value}function Ke(e){var r,o,i,u;const t=Object.keys(e.shape);for(const s of t)if(!((u=(i=(o=(r=e.shape)==null?void 0:r[s])==null?void 0:o._zod)==null?void 0:i.traits)!=null&&u.has("$ZodType")))throw new Error(`Invalid element at key "${s}": expected a Zod schema`);const n=Wt(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(n)}}function Be(e,t,n,r,o,i){const u=[],s=o.keySet,c=o.catchall._zod,l=c.def.type;for(const h in t){if(s.has(h))continue;if(l==="never"){u.push(h);continue}const m=c.run({value:t[h],issues:[]},r);m instanceof Promise?e.push(m.then(f=>re(f,n,h,t))):re(m,n,h,t)}return u.length&&n.issues.push({code:"unrecognized_keys",keys:u,input:t,inst:i}),e.length?Promise.all(e).then(()=>n):n}const Sr=a("$ZodObject",(e,t)=>{k.init(e,t);const n=Object.getOwnPropertyDescriptor(t,"shape");if(!(n!=null&&n.get)){const s=t.shape;Object.defineProperty(t,"shape",{get:()=>{const c={...s};return Object.defineProperty(t,"shape",{value:c}),c}})}const r=de(()=>Ke(t));g(e._zod,"propValues",()=>{var l;const s=t.shape,c={};for(const h in s){const m=s[h]._zod;if(m.values){(l=c[h])!=null||(c[h]=new Set);for(const f of m.values)c[h].add(f)}}return c});const o=Q,i=t.catchall;let u;e._zod.parse=(s,c)=>{u!=null||(u=r.value);const l=s.value;if(!o(l))return s.issues.push({expected:"object",code:"invalid_type",input:l,inst:e}),s;s.value={};const h=[],m=u.shape;for(const f of u.keys){const b=m[f]._zod.run({value:l[f],issues:[]},c);b instanceof Promise?h.push(b.then(R=>re(R,s,f,l))):re(b,s,f,l)}return i?Be(h,l,s,c,r.value,e):h.length?Promise.all(h).then(()=>s):s}}),Tr=a("$ZodObjectJIT",(e,t)=>{Sr.init(e,t);const n=e._zod.parse,r=de(()=>Ke(t)),o=f=>{const p=new Xn(["shape","payload","ctx"]),b=r.value,R=P=>{const T=Te(P);return`shape[${T}]._zod.run({ value: input[${T}], issues: [] }, ctx)`};p.write("const input = payload.value;");const j=Object.create(null);let U=0;for(const P of b.keys)j[P]=`key_${U++}`;p.write("const newResult = {};");for(const P of b.keys){const T=j[P],J=Te(P);p.write(`const ${T} = ${R(P)};`),p.write(`
        if (${T}.issues.length) {
          payload.issues = payload.issues.concat(${T}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${J}, ...iss.path] : [${J}]
          })));
        }
        
        
        if (${T}.value === undefined) {
          if (${J} in input) {
            newResult[${J}] = undefined;
          }
        } else {
          newResult[${J}] = ${T}.value;
        }
        
      `)}p.write("payload.value = newResult;"),p.write("return payload;");const $e=p.compile();return(P,T)=>$e(f,P,T)};let i;const u=Q,s=!Oe.jitless,l=s&&qt.value,h=t.catchall;let m;e._zod.parse=(f,p)=>{m!=null||(m=r.value);const b=f.value;return u(b)?s&&l&&(p==null?void 0:p.async)===!1&&p.jitless!==!0?(i||(i=o(t.shape)),f=i(f,p),h?Be([],b,f,p,m,e):f):n(f,p):(f.issues.push({expected:"object",code:"invalid_type",input:b,inst:e}),f)}});function Je(e,t,n,r){for(const i of e)if(i.issues.length===0)return t.value=i.value,t;const o=e.filter(i=>!q(i));return o.length===1?(t.value=o[0].value,o[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map(i=>i.issues.map(u=>D(u,r,N())))}),t)}const Ar=a("$ZodUnion",(e,t)=>{k.init(e,t),g(e._zod,"optin",()=>t.options.some(o=>o._zod.optin==="optional")?"optional":void 0),g(e._zod,"optout",()=>t.options.some(o=>o._zod.optout==="optional")?"optional":void 0),g(e._zod,"values",()=>{if(t.options.every(o=>o._zod.values))return new Set(t.options.flatMap(o=>Array.from(o._zod.values)))}),g(e._zod,"pattern",()=>{if(t.options.every(o=>o._zod.pattern)){const o=t.options.map(i=>i._zod.pattern);return new RegExp(`^(${o.map(i=>me(i.source)).join("|")})$`)}});const n=t.options.length===1,r=t.options[0]._zod.run;e._zod.parse=(o,i)=>{if(n)return r(o,i);let u=!1;const s=[];for(const c of t.options){const l=c._zod.run({value:o.value,issues:[]},i);if(l instanceof Promise)s.push(l),u=!0;else{if(l.issues.length===0)return l;s.push(l)}}return u?Promise.all(s).then(c=>Je(c,o,e,i)):Je(s,o,e,i)}}),Pr=a("$ZodIntersection",(e,t)=>{k.init(e,t),e._zod.parse=(n,r)=>{const o=n.value,i=t.left._zod.run({value:o,issues:[]},r),u=t.right._zod.run({value:o,issues:[]},r);return i instanceof Promise||u instanceof Promise?Promise.all([i,u]).then(([c,l])=>Ye(n,c,l)):Ye(n,i,u)}});function we(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(V(e)&&V(t)){const n=Object.keys(t),r=Object.keys(e).filter(i=>n.indexOf(i)!==-1),o={...e,...t};for(const i of r){const u=we(e[i],t[i]);if(!u.valid)return{valid:!1,mergeErrorPath:[i,...u.mergeErrorPath]};o[i]=u.data}return{valid:!0,data:o}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let r=0;r<e.length;r++){const o=e[r],i=t[r],u=we(o,i);if(!u.valid)return{valid:!1,mergeErrorPath:[r,...u.mergeErrorPath]};n.push(u.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function Ye(e,t,n){if(t.issues.length&&e.issues.push(...t.issues),n.issues.length&&e.issues.push(...n.issues),q(e))return e;const r=we(t.value,n.value);if(!r.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return e.value=r.data,e}const Nr=a("$ZodRecord",(e,t)=>{k.init(e,t),e._zod.parse=(n,r)=>{const o=n.value;if(!V(o))return n.issues.push({expected:"record",code:"invalid_type",input:o,inst:e}),n;const i=[],u=t.keyType._zod.values;if(u){n.value={};const s=new Set;for(const l of u)if(typeof l=="string"||typeof l=="number"||typeof l=="symbol"){s.add(typeof l=="number"?l.toString():l);const h=t.valueType._zod.run({value:o[l],issues:[]},r);h instanceof Promise?i.push(h.then(m=>{m.issues.length&&n.issues.push(...G(l,m.issues)),n.value[l]=m.value})):(h.issues.length&&n.issues.push(...G(l,h.issues)),n.value[l]=h.value)}let c;for(const l in o)s.has(l)||(c=c!=null?c:[],c.push(l));c&&c.length>0&&n.issues.push({code:"unrecognized_keys",input:o,inst:e,keys:c})}else{n.value={};for(const s of Reflect.ownKeys(o)){if(s==="__proto__")continue;const c=t.keyType._zod.run({value:s,issues:[]},r);if(c instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(c.issues.length){n.issues.push({code:"invalid_key",origin:"record",issues:c.issues.map(h=>D(h,r,N())),input:s,path:[s],inst:e}),n.value[c.value]=c.value;continue}const l=t.valueType._zod.run({value:o[s],issues:[]},r);l instanceof Promise?i.push(l.then(h=>{h.issues.length&&n.issues.push(...G(s,h.issues)),n.value[c.value]=h.value})):(l.issues.length&&n.issues.push(...G(s,l.issues)),n.value[c.value]=l.value)}}return i.length?Promise.all(i).then(()=>n):n}}),Cr=a("$ZodEnum",(e,t)=>{k.init(e,t);const n=xt(t.entries),r=new Set(n);e._zod.values=r,e._zod.pattern=new RegExp(`^(${n.filter(o=>Gt.has(typeof o)).map(o=>typeof o=="string"?X(o):o.toString()).join("|")})$`),e._zod.parse=(o,i)=>{const u=o.value;return r.has(u)||o.issues.push({code:"invalid_value",values:n,input:u,inst:e}),o}}),Dr=a("$ZodTransform",(e,t)=>{k.init(e,t),e._zod.parse=(n,r)=>{if(r.direction==="backward")throw new Re(e.constructor.name);const o=t.transform(n.value,n);if(r.async)return(o instanceof Promise?o:Promise.resolve(o)).then(u=>(n.value=u,n));if(o instanceof Promise)throw new M;return n.value=o,n}});function Qe(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const jr=a("$ZodOptional",(e,t)=>{k.init(e,t),e._zod.optin="optional",e._zod.optout="optional",g(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),g(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${me(n.source)})?$`):void 0}),e._zod.parse=(n,r)=>{if(t.innerType._zod.optin==="optional"){const o=t.innerType._zod.run(n,r);return o instanceof Promise?o.then(i=>Qe(i,n.value)):Qe(o,n.value)}return n.value===void 0?n:t.innerType._zod.run(n,r)}}),Ur=a("$ZodNullable",(e,t)=>{k.init(e,t),g(e._zod,"optin",()=>t.innerType._zod.optin),g(e._zod,"optout",()=>t.innerType._zod.optout),g(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${me(n.source)}|null)$`):void 0}),g(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(n,r)=>n.value===null?n:t.innerType._zod.run(n,r)}),Fr=a("$ZodDefault",(e,t)=>{k.init(e,t),e._zod.optin="optional",g(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>{if(r.direction==="backward")return t.innerType._zod.run(n,r);if(n.value===void 0)return n.value=t.defaultValue,n;const o=t.innerType._zod.run(n,r);return o instanceof Promise?o.then(i=>Xe(i,t)):Xe(o,t)}});function Xe(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const Lr=a("$ZodPrefault",(e,t)=>{k.init(e,t),e._zod.optin="optional",g(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>(r.direction==="backward"||n.value===void 0&&(n.value=t.defaultValue),t.innerType._zod.run(n,r))}),xr=a("$ZodNonOptional",(e,t)=>{k.init(e,t),g(e._zod,"values",()=>{const n=t.innerType._zod.values;return n?new Set([...n].filter(r=>r!==void 0)):void 0}),e._zod.parse=(n,r)=>{const o=t.innerType._zod.run(n,r);return o instanceof Promise?o.then(i=>He(i,e)):He(o,e)}});function He(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const Mr=a("$ZodCatch",(e,t)=>{k.init(e,t),g(e._zod,"optin",()=>t.innerType._zod.optin),g(e._zod,"optout",()=>t.innerType._zod.optout),g(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>{if(r.direction==="backward")return t.innerType._zod.run(n,r);const o=t.innerType._zod.run(n,r);return o instanceof Promise?o.then(i=>(n.value=i.value,i.issues.length&&(n.value=t.catchValue({...n,error:{issues:i.issues.map(u=>D(u,r,N()))},input:n.value}),n.issues=[]),n)):(n.value=o.value,o.issues.length&&(n.value=t.catchValue({...n,error:{issues:o.issues.map(i=>D(i,r,N()))},input:n.value}),n.issues=[]),n)}}),Vr=a("$ZodPipe",(e,t)=>{k.init(e,t),g(e._zod,"values",()=>t.in._zod.values),g(e._zod,"optin",()=>t.in._zod.optin),g(e._zod,"optout",()=>t.out._zod.optout),g(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(n,r)=>{if(r.direction==="backward"){const i=t.out._zod.run(n,r);return i instanceof Promise?i.then(u=>oe(u,t.in,r)):oe(i,t.in,r)}const o=t.in._zod.run(n,r);return o instanceof Promise?o.then(i=>oe(i,t.out,r)):oe(o,t.out,r)}});function oe(e,t,n){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},n)}const qr=a("$ZodReadonly",(e,t)=>{k.init(e,t),g(e._zod,"propValues",()=>t.innerType._zod.propValues),g(e._zod,"values",()=>t.innerType._zod.values),g(e._zod,"optin",()=>{var n,r;return(r=(n=t.innerType)==null?void 0:n._zod)==null?void 0:r.optin}),g(e._zod,"optout",()=>{var n,r;return(r=(n=t.innerType)==null?void 0:n._zod)==null?void 0:r.optout}),e._zod.parse=(n,r)=>{if(r.direction==="backward")return t.innerType._zod.run(n,r);const o=t.innerType._zod.run(n,r);return o instanceof Promise?o.then(et):et(o)}});function et(e){return e.value=Object.freeze(e.value),e}const Gr=a("$ZodCustom",(e,t)=>{Z.init(e,t),k.init(e,t),e._zod.parse=(n,r)=>n,e._zod.check=n=>{const r=n.value,o=t.fn(r);if(o instanceof Promise)return o.then(i=>tt(i,n,r,e));tt(o,n,r,e)}});function tt(e,t,n,r){var o;if(!e){const i={code:"custom",input:n,inst:r,path:[...(o=r._zod.def.path)!=null?o:[]],continue:!r._zod.def.abort};r._zod.def.params&&(i.params=r._zod.def.params),t.issues.push(B(i))}}var nt;class Wr{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...n){const r=n[0];if(this._map.set(t,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,t)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const n=this._map.get(t);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(t),this}get(t){var r;const n=t._zod.parent;if(n){const o={...(r=this.get(n))!=null?r:{}};delete o.id;const i={...o,...this._map.get(t)};return Object.keys(i).length?i:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function Kr(){return new Wr}(zt=(nt=globalThis).__zod_globalRegistry)!=null||(nt.__zod_globalRegistry=Kr());const ie=globalThis.__zod_globalRegistry;function Br(e,t){return new e({type:"string",...d(t)})}function Jr(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...d(t)})}function rt(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...d(t)})}function Yr(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...d(t)})}function Qr(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...d(t)})}function Xr(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...d(t)})}function Hr(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...d(t)})}function eo(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...d(t)})}function to(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...d(t)})}function no(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...d(t)})}function ro(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...d(t)})}function oo(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...d(t)})}function io(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...d(t)})}function uo(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...d(t)})}function co(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...d(t)})}function so(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...d(t)})}function ao(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...d(t)})}function lo(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...d(t)})}function fo(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...d(t)})}function ho(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...d(t)})}function po(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...d(t)})}function mo(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...d(t)})}function _o(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...d(t)})}function go(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...d(t)})}function vo(e,t){return new e({type:"string",format:"date",check:"string_format",...d(t)})}function bo(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...d(t)})}function wo(e,t){return new e({type:"string",format:"duration",check:"string_format",...d(t)})}function ko(e,t){return new e({type:"number",checks:[],...d(t)})}function zo(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...d(t)})}function yo(e,t){return new e({type:"boolean",...d(t)})}function Eo(e){return new e({type:"unknown"})}function Zo(e,t){return new e({type:"never",...d(t)})}function ot(e,t){return new Me({check:"less_than",...d(t),value:e,inclusive:!1})}function ke(e,t){return new Me({check:"less_than",...d(t),value:e,inclusive:!0})}function it(e,t){return new Ve({check:"greater_than",...d(t),value:e,inclusive:!1})}function ze(e,t){return new Ve({check:"greater_than",...d(t),value:e,inclusive:!0})}function ut(e,t){return new Ln({check:"multiple_of",...d(t),value:e})}function ct(e,t){return new Mn({check:"max_length",...d(t),maximum:e})}function ue(e,t){return new Vn({check:"min_length",...d(t),minimum:e})}function st(e,t){return new qn({check:"length_equals",...d(t),length:e})}function $o(e,t){return new Gn({check:"string_format",format:"regex",...d(t),pattern:e})}function Io(e){return new Wn({check:"string_format",format:"lowercase",...d(e)})}function Ro(e){return new Kn({check:"string_format",format:"uppercase",...d(e)})}function Oo(e,t){return new Bn({check:"string_format",format:"includes",...d(t),includes:e})}function So(e,t){return new Jn({check:"string_format",format:"starts_with",...d(t),prefix:e})}function To(e,t){return new Yn({check:"string_format",format:"ends_with",...d(t),suffix:e})}function W(e){return new Qn({check:"overwrite",tx:e})}function Ao(e){return W(t=>t.normalize(e))}function Po(){return W(e=>e.trim())}function No(){return W(e=>e.toLowerCase())}function Co(){return W(e=>e.toUpperCase())}function Do(){return W(e=>Vt(e))}function jo(e,t,n){return new e({type:"array",element:t,...d(n)})}function Uo(e,t,n){return new e({type:"custom",check:"custom",fn:t,...d(n)})}function Fo(e){const t=Lo(n=>(n.addIssue=r=>{var o,i,u,s;if(typeof r=="string")n.issues.push(B(r,n.value,t._zod.def));else{const c=r;c.fatal&&(c.continue=!1),(o=c.code)!=null||(c.code="custom"),(i=c.input)!=null||(c.input=n.value),(u=c.inst)!=null||(c.inst=t),(s=c.continue)!=null||(c.continue=!t._zod.def.abort),n.issues.push(B(c))}},e(n.value,n)));return t}function Lo(e,t){const n=new Z({check:"custom",...d(t)});return n._zod.check=e,n}const xo=a("ZodISODateTime",(e,t)=>{fr.init(e,t),w.init(e,t)});function Mo(e){return go(xo,e)}const Vo=a("ZodISODate",(e,t)=>{hr.init(e,t),w.init(e,t)});function qo(e){return vo(Vo,e)}const Go=a("ZodISOTime",(e,t)=>{dr.init(e,t),w.init(e,t)});function Wo(e){return bo(Go,e)}const Ko=a("ZodISODuration",(e,t)=>{pr.init(e,t),w.init(e,t)});function Bo(e){return wo(Ko,e)}const I=a("ZodError",(e,t)=>{Ce.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:n=>nn(e,n)},flatten:{value:n=>tn(e,n)},addIssue:{value:n=>{e.issues.push(n),e.message=JSON.stringify(e.issues,he,2)}},addIssues:{value:n=>{e.issues.push(...n),e.message=JSON.stringify(e.issues,he,2)}},isEmpty:{get(){return e.issues.length===0}}})},{Parent:Error}),Jo=ge(I),Yo=ve(I),Qo=ee(I),Xo=te(I),Ho=un(I),ei=cn(I),ti=sn(I),ni=an(I),ri=ln(I),oi=fn(I),ii=hn(I),ui=dn(I),z=a("ZodType",(e,t)=>(k.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...n)=>{var r;return e.clone(L(t,{checks:[...(r=t.checks)!=null?r:[],...n.map(o=>typeof o=="function"?{_zod:{check:o,def:{check:"custom"},onattach:[]}}:o)]}))},e.clone=(n,r)=>C(e,n,r),e.brand=()=>e,e.register=((n,r)=>(n.add(e,r),e)),e.parse=(n,r)=>Jo(e,n,r,{callee:e.parse}),e.safeParse=(n,r)=>Qo(e,n,r),e.parseAsync=async(n,r)=>Yo(e,n,r,{callee:e.parseAsync}),e.safeParseAsync=async(n,r)=>Xo(e,n,r),e.spa=e.safeParseAsync,e.encode=(n,r)=>Ho(e,n,r),e.decode=(n,r)=>ei(e,n,r),e.encodeAsync=async(n,r)=>ti(e,n,r),e.decodeAsync=async(n,r)=>ni(e,n,r),e.safeEncode=(n,r)=>ri(e,n,r),e.safeDecode=(n,r)=>oi(e,n,r),e.safeEncodeAsync=async(n,r)=>ii(e,n,r),e.safeDecodeAsync=async(n,r)=>ui(e,n,r),e.refine=(n,r)=>e.check(Xi(n,r)),e.superRefine=n=>e.check(Hi(n)),e.overwrite=n=>e.check(W(n)),e.optional=()=>mt(e),e.nullable=()=>_t(e),e.nullish=()=>mt(_t(e)),e.nonoptional=n=>Gi(e,n),e.array=()=>ye(e),e.or=n=>Ni([e,n]),e.and=n=>Di(e,n),e.transform=n=>vt(e,Fi(n)),e.default=n=>Mi(e,n),e.prefault=n=>qi(e,n),e.catch=n=>Ki(e,n),e.pipe=n=>vt(e,n),e.readonly=()=>Yi(e),e.describe=n=>{const r=e.clone();return ie.add(r,{description:n}),r},Object.defineProperty(e,"description",{get(){var n;return(n=ie.get(e))==null?void 0:n.description},configurable:!0}),e.meta=(...n)=>{if(n.length===0)return ie.get(e);const r=e.clone();return ie.add(r,n[0]),r},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),at=a("_ZodString",(e,t)=>{var r,o,i;be.init(e,t),z.init(e,t);const n=e._zod.bag;e.format=(r=n.format)!=null?r:null,e.minLength=(o=n.minimum)!=null?o:null,e.maxLength=(i=n.maximum)!=null?i:null,e.regex=(...u)=>e.check($o(...u)),e.includes=(...u)=>e.check(Oo(...u)),e.startsWith=(...u)=>e.check(So(...u)),e.endsWith=(...u)=>e.check(To(...u)),e.min=(...u)=>e.check(ue(...u)),e.max=(...u)=>e.check(ct(...u)),e.length=(...u)=>e.check(st(...u)),e.nonempty=(...u)=>e.check(ue(1,...u)),e.lowercase=u=>e.check(Io(u)),e.uppercase=u=>e.check(Ro(u)),e.trim=()=>e.check(Po()),e.normalize=(...u)=>e.check(Ao(...u)),e.toLowerCase=()=>e.check(No()),e.toUpperCase=()=>e.check(Co()),e.slugify=()=>e.check(Do())}),ci=a("ZodString",(e,t)=>{be.init(e,t),at.init(e,t),e.email=n=>e.check(Jr(si,n)),e.url=n=>e.check(eo(ai,n)),e.jwt=n=>e.check(_o(Ei,n)),e.emoji=n=>e.check(to(li,n)),e.guid=n=>e.check(rt(lt,n)),e.uuid=n=>e.check(Yr(ce,n)),e.uuidv4=n=>e.check(Qr(ce,n)),e.uuidv6=n=>e.check(Xr(ce,n)),e.uuidv7=n=>e.check(Hr(ce,n)),e.nanoid=n=>e.check(no(fi,n)),e.guid=n=>e.check(rt(lt,n)),e.cuid=n=>e.check(ro(hi,n)),e.cuid2=n=>e.check(oo(di,n)),e.ulid=n=>e.check(io(pi,n)),e.base64=n=>e.check(ho(ki,n)),e.base64url=n=>e.check(po(zi,n)),e.xid=n=>e.check(uo(mi,n)),e.ksuid=n=>e.check(co(_i,n)),e.ipv4=n=>e.check(so(gi,n)),e.ipv6=n=>e.check(ao(vi,n)),e.cidrv4=n=>e.check(lo(bi,n)),e.cidrv6=n=>e.check(fo(wi,n)),e.e164=n=>e.check(mo(yi,n)),e.datetime=n=>e.check(Mo(n)),e.date=n=>e.check(qo(n)),e.time=n=>e.check(Wo(n)),e.duration=n=>e.check(Bo(n))});function A(e){return Br(ci,e)}const w=a("ZodStringFormat",(e,t)=>{v.init(e,t),at.init(e,t)}),si=a("ZodEmail",(e,t)=>{nr.init(e,t),w.init(e,t)}),lt=a("ZodGUID",(e,t)=>{er.init(e,t),w.init(e,t)}),ce=a("ZodUUID",(e,t)=>{tr.init(e,t),w.init(e,t)}),ai=a("ZodURL",(e,t)=>{rr.init(e,t),w.init(e,t)}),li=a("ZodEmoji",(e,t)=>{or.init(e,t),w.init(e,t)}),fi=a("ZodNanoID",(e,t)=>{ir.init(e,t),w.init(e,t)}),hi=a("ZodCUID",(e,t)=>{ur.init(e,t),w.init(e,t)}),di=a("ZodCUID2",(e,t)=>{cr.init(e,t),w.init(e,t)}),pi=a("ZodULID",(e,t)=>{sr.init(e,t),w.init(e,t)}),mi=a("ZodXID",(e,t)=>{ar.init(e,t),w.init(e,t)}),_i=a("ZodKSUID",(e,t)=>{lr.init(e,t),w.init(e,t)}),gi=a("ZodIPv4",(e,t)=>{mr.init(e,t),w.init(e,t)}),vi=a("ZodIPv6",(e,t)=>{_r.init(e,t),w.init(e,t)}),bi=a("ZodCIDRv4",(e,t)=>{gr.init(e,t),w.init(e,t)}),wi=a("ZodCIDRv6",(e,t)=>{vr.init(e,t),w.init(e,t)}),ki=a("ZodBase64",(e,t)=>{br.init(e,t),w.init(e,t)}),zi=a("ZodBase64URL",(e,t)=>{kr.init(e,t),w.init(e,t)}),yi=a("ZodE164",(e,t)=>{zr.init(e,t),w.init(e,t)}),Ei=a("ZodJWT",(e,t)=>{Er.init(e,t),w.init(e,t)}),ft=a("ZodNumber",(e,t)=>{var r,o,i,u,s,c,l,h,m;Ge.init(e,t),z.init(e,t),e.gt=(f,p)=>e.check(it(f,p)),e.gte=(f,p)=>e.check(ze(f,p)),e.min=(f,p)=>e.check(ze(f,p)),e.lt=(f,p)=>e.check(ot(f,p)),e.lte=(f,p)=>e.check(ke(f,p)),e.max=(f,p)=>e.check(ke(f,p)),e.int=f=>e.check(ht(f)),e.safe=f=>e.check(ht(f)),e.positive=f=>e.check(it(0,f)),e.nonnegative=f=>e.check(ze(0,f)),e.negative=f=>e.check(ot(0,f)),e.nonpositive=f=>e.check(ke(0,f)),e.multipleOf=(f,p)=>e.check(ut(f,p)),e.step=(f,p)=>e.check(ut(f,p)),e.finite=()=>e;const n=e._zod.bag;e.minValue=(i=Math.max((r=n.minimum)!=null?r:Number.NEGATIVE_INFINITY,(o=n.exclusiveMinimum)!=null?o:Number.NEGATIVE_INFINITY))!=null?i:null,e.maxValue=(c=Math.min((u=n.maximum)!=null?u:Number.POSITIVE_INFINITY,(s=n.exclusiveMaximum)!=null?s:Number.POSITIVE_INFINITY))!=null?c:null,e.isInt=((l=n.format)!=null?l:"").includes("int")||Number.isSafeInteger((h=n.multipleOf)!=null?h:.5),e.isFinite=!0,e.format=(m=n.format)!=null?m:null});function S(e){return ko(ft,e)}const Zi=a("ZodNumberFormat",(e,t)=>{Zr.init(e,t),ft.init(e,t)});function ht(e){return zo(Zi,e)}const $i=a("ZodBoolean",(e,t)=>{$r.init(e,t),z.init(e,t)});function Ii(e){return yo($i,e)}const Ri=a("ZodUnknown",(e,t)=>{Ir.init(e,t),z.init(e,t)});function se(){return Eo(Ri)}const Oi=a("ZodNever",(e,t)=>{Rr.init(e,t),z.init(e,t)});function Si(e){return Zo(Oi,e)}const Ti=a("ZodArray",(e,t)=>{Or.init(e,t),z.init(e,t),e.element=t.element,e.min=(n,r)=>e.check(ue(n,r)),e.nonempty=n=>e.check(ue(1,n)),e.max=(n,r)=>e.check(ct(n,r)),e.length=(n,r)=>e.check(st(n,r)),e.unwrap=()=>e.element});function ye(e,t){return jo(Ti,e,t)}const Ai=a("ZodObject",(e,t)=>{Tr.init(e,t),z.init(e,t),g(e,"shape",()=>t.shape),e.keyof=()=>ae(Object.keys(e._zod.def.shape)),e.catchall=n=>e.clone({...e._zod.def,catchall:n}),e.passthrough=()=>e.clone({...e._zod.def,catchall:se()}),e.loose=()=>e.clone({...e._zod.def,catchall:se()}),e.strict=()=>e.clone({...e._zod.def,catchall:Si()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=n=>Yt(e,n),e.safeExtend=n=>Qt(e,n),e.merge=n=>Xt(e,n),e.pick=n=>Bt(e,n),e.omit=n=>Jt(e,n),e.partial=(...n)=>Ht(pt,e,n[0]),e.required=(...n)=>en(gt,e,n[0])});function K(e,t){const n={type:"object",shape:e!=null?e:{},...d(t)};return new Ai(n)}const Pi=a("ZodUnion",(e,t)=>{Ar.init(e,t),z.init(e,t),e.options=t.options});function Ni(e,t){return new Pi({type:"union",options:e,...d(t)})}const Ci=a("ZodIntersection",(e,t)=>{Pr.init(e,t),z.init(e,t)});function Di(e,t){return new Ci({type:"intersection",left:e,right:t})}const ji=a("ZodRecord",(e,t)=>{Nr.init(e,t),z.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});function dt(e,t,n){return new ji({type:"record",keyType:e,valueType:t,...d(n)})}const Ee=a("ZodEnum",(e,t)=>{Cr.init(e,t),z.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const n=new Set(Object.keys(t.entries));e.extract=(r,o)=>{const i={};for(const u of r)if(n.has(u))i[u]=t.entries[u];else throw new Error(`Key ${u} not found in enum`);return new Ee({...t,checks:[],...d(o),entries:i})},e.exclude=(r,o)=>{const i={...t.entries};for(const u of r)if(n.has(u))delete i[u];else throw new Error(`Key ${u} not found in enum`);return new Ee({...t,checks:[],...d(o),entries:i})}});function ae(e,t){const n=Array.isArray(e)?Object.fromEntries(e.map(r=>[r,r])):e;return new Ee({type:"enum",entries:n,...d(t)})}const Ui=a("ZodTransform",(e,t)=>{Dr.init(e,t),z.init(e,t),e._zod.parse=(n,r)=>{if(r.direction==="backward")throw new Re(e.constructor.name);n.addIssue=i=>{var u,s,c;if(typeof i=="string")n.issues.push(B(i,n.value,t));else{const l=i;l.fatal&&(l.continue=!1),(u=l.code)!=null||(l.code="custom"),(s=l.input)!=null||(l.input=n.value),(c=l.inst)!=null||(l.inst=e),n.issues.push(B(l))}};const o=t.transform(n.value,n);return o instanceof Promise?o.then(i=>(n.value=i,n)):(n.value=o,n)}});function Fi(e){return new Ui({type:"transform",transform:e})}const pt=a("ZodOptional",(e,t)=>{jr.init(e,t),z.init(e,t),e.unwrap=()=>e._zod.def.innerType});function mt(e){return new pt({type:"optional",innerType:e})}const Li=a("ZodNullable",(e,t)=>{Ur.init(e,t),z.init(e,t),e.unwrap=()=>e._zod.def.innerType});function _t(e){return new Li({type:"nullable",innerType:e})}const xi=a("ZodDefault",(e,t)=>{Fr.init(e,t),z.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function Mi(e,t){return new xi({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():Pe(t)}})}const Vi=a("ZodPrefault",(e,t)=>{Lr.init(e,t),z.init(e,t),e.unwrap=()=>e._zod.def.innerType});function qi(e,t){return new Vi({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():Pe(t)}})}const gt=a("ZodNonOptional",(e,t)=>{xr.init(e,t),z.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Gi(e,t){return new gt({type:"nonoptional",innerType:e,...d(t)})}const Wi=a("ZodCatch",(e,t)=>{Mr.init(e,t),z.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function Ki(e,t){return new Wi({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const Bi=a("ZodPipe",(e,t)=>{Vr.init(e,t),z.init(e,t),e.in=t.in,e.out=t.out});function vt(e,t){return new Bi({type:"pipe",in:e,out:t})}const Ji=a("ZodReadonly",(e,t)=>{qr.init(e,t),z.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Yi(e){return new Ji({type:"readonly",innerType:e})}const Qi=a("ZodCustom",(e,t)=>{Gr.init(e,t),z.init(e,t)});function Xi(e,t={}){return Uo(Qi,e,t)}function Hi(e){return Fo(e)}const eu=K({variant:ae(["toggle","checkbox"]),page:ae(["cart","checkout"]),retailerMoniker:A().min(1),region:A().min(1),locale:A().min(2),environment:ae(["qa","st","prod"]).optional().default("qa"),configUrl:A().url().optional(),experiment:dt(se()).optional(),debug:Ii().optional(),mockMode:dt(se()).optional()}),tu=K({retailerMoniker:A().min(1),region:A().min(1),locale:A().min(2),pricing:K({percentage:S().nonnegative().optional(),fixedFee:S().nonnegative().optional(),tiers:ye(K({threshold:S().nonnegative(),percentage:S().nonnegative().optional(),fixedFee:S().nonnegative().optional()})).optional()})}),nu=K({sku:A().min(1),quantity:S().int().positive(),price:S().nonnegative()}),ru=K({items:ye(nu),subtotal:S().nonnegative(),currency:A().length(3),fees:S().nonnegative().optional(),discounts:S().nonnegative().optional()});class ou{constructor(){O(this,"cache",null)}async fetchConfiguration(t){try{const n=await fetch(t);if(!n.ok)return E($("CONFIG_ERROR",`Config fetch failed: ${n.status}`));const r=await n.json(),o=tu.safeParse(r);return o.success?(this.cache=o.data,y(o.data)):E($("CONFIG_ERROR","Invalid config schema",o.error))}catch(n){return E($("NETWORK_ERROR","Config fetch error",n))}}getConfiguration(){return this.cache}}class iu{constructor(){O(this,"state","UNINITIALIZED");O(this,"bus",new Nt);O(this,"configService",new ou);O(this,"quoteCalc",null);O(this,"sdkConfig",null)}getState(){return this.state}on(t,n){this.bus.on(t,n)}off(t,n){this.bus.off(t,n)}async initialize(t){this.transition({type:"INITIALIZE"}),this.sdkConfig=t.sdkConfig;const n=await this.configService.fetchConfiguration(t.configUrl);return n.ok?(this.quoteCalc=new Lt(n.value),this.transition({type:"READY"}),this.bus.emit("narvar:shipping-protection:state:ready",{}),y(void 0)):(this.transition({type:"ERROR"}),this.bus.emit("narvar:shipping-protection:state:error",{error:n.error}),E(n.error))}async calculateQuote(t){if(!this.quoteCalc){this.transition({type:"ERROR"});const n=$("CONFIG_ERROR","Quote calculator not initialized");return this.bus.emit("narvar:shipping-protection:state:error",{error:n}),E(n)}if(!this.sdkConfig){this.transition({type:"ERROR"});const n=$("CONFIG_ERROR","SDK config not initialized");return this.bus.emit("narvar:shipping-protection:state:error",{error:n}),E(n)}if(this.transition({type:"CALCULATE_QUOTE"}),this.sdkConfig.page==="checkout"){const n=await this.quoteCalc.calculateWithEdge(t,this.sdkConfig);return n.ok?(this.transition({type:"QUOTE_READY"}),this.bus.emit("narvar:shipping-protection:state:quote-available",{quote:n.value}),y(n.value)):(this.transition({type:"ERROR"}),this.bus.emit("narvar:shipping-protection:state:error",{error:n.error}),n)}else{const r={...this.quoteCalc.calculate(t),source:"client"};return this.transition({type:"QUOTE_READY"}),this.bus.emit("narvar:shipping-protection:state:quote-available",{quote:r}),y(r)}}selectProtection(t={}){this.transition({type:"SELECT_PROTECTION"}),this.bus.emit("narvar:shipping-protection:action:add-protection",t)}declineProtection(t={}){this.transition({type:"DECLINE_PROTECTION"}),this.bus.emit("narvar:shipping-protection:action:remove-protection",t)}destroy(){this.transition({type:"DESTROY"})}transition(t){this.state=Ct(this.state,t)}}function bt(e,t){return e().then(n=>y(n)).catch(n=>{const r=n instanceof Error?n.message:String(n),o=$("UNKNOWN_ERROR",`${t}: ${r}`,n);return E(o)})}function uu(e,t){let n=null,r=null,o=null;return(...i)=>(n!==null&&clearTimeout(n),new Promise((u,s)=>{r=u,o=s,n=setTimeout(async()=>{try{const c=await e(...i);r==null||r(c)}catch(c){o==null||o(c)}},t)}))}const Ze={};class wt{constructor(){O(this,"coordinator");O(this,"ready",!1);O(this,"initPromise",null);O(this,"renderDebounced");this.coordinator=new iu,this.renderDebounced=uu(this.renderInternal.bind(this),100)}async init(t){return this.initPromise?this.initPromise:(this.initPromise=bt(async()=>{const n=eu.safeParse(t);if(!n.success)throw $("CONFIG_ERROR","Invalid SDK config",n.error);const r=n.data,i={configUrl:r.configUrl||`https://config.narvar.com/${r.retailerMoniker}/${r.environment||"qa"}/shipping-protection.json`,sdkConfig:r},u=new Promise((c,l)=>setTimeout(()=>l($("CONFIG_ERROR","SDK initialization timeout after 10s")),le.INIT)),s=await Promise.race([this.coordinator.initialize(i),u]);if(!s.ok)throw s.error;this.ready=!0},"SecureAPI.init"),this.initPromise)}async render(t){return this.renderDebounced(t)}async renderInternal(t){return bt(async()=>{if(!this.ready)throw $("CONFIG_ERROR","SDK not ready - call init() first");const n=ru.safeParse(t);if(!n.success)throw $("CONFIG_ERROR","Invalid cart data",n.error);const r=await this.coordinator.calculateQuote(n.data);if(!r.ok)throw r.error;return r.value},"SecureAPI.render")}on(t,n){return this.coordinator.on(t,n),()=>this.off(t,n)}off(t,n){this.coordinator.off(t,n)}setCustomerIdentity(t){console.log("[ShippingProtection] Customer identity set:",t)}getVersion(){return(Ze==null?void 0:Ze.VITE_SECURE_SDK_VERSION)||"0.0.1"}isReady(){return this.ready}destroy(){this.coordinator.destroy(),this.ready=!1,this.initPromise=null}}const x=new wt,cu=x;function su(){const e=typeof CustomEvent!="undefined",t=(()=>{try{return"attachShadow"in Element.prototype}catch{return!1}})(),n=(()=>{try{const o="__storage_test__";return window.localStorage.setItem(o,o),window.localStorage.removeItem(o),!0}catch{return!1}})(),r=typeof window.fetch=="function";return{customEvent:e,shadowDOM:t,localStorage:n,fetch:r,all:e&&t&&n&&r}}const kt="0.0.1";function au(){return kt}(function(){const t="NarvarShippingProtection",n=globalThis,r=n[t],o=su();if(!o.all){const u=Object.entries(o).filter(([s,c])=>s!=="all"&&!c).map(([s])=>s);console.error("[ShippingProtection] Browser unsupported. Missing features:",u),r&&r._failed!==void 0&&(r._failed=!0);return}const i=Array.isArray(r==null?void 0:r._queue)?r._queue:[];n[t]=x,n.Narvar=n.Narvar||{},n.Narvar.ShippingProtection=x,x._real=!0,typeof(r==null?void 0:r._failed)=="boolean"&&(x._failed=r._failed),i.length&&i.forEach(([u,s])=>{const c=x[u];typeof c=="function"&&c(...s)})})(),_.NarvarSecure=x,_.NarvarShippingProtection=cu,_.SECURE_SDK_VERSION=kt,_.SecureAPI=wt,_.TIMEOUTS=le,_.andThen=Zt,_.err=E,_.getVersion=au,_.isErr=yt,_.isOk=Y,_.mapResult=Et,_.ok=y,_.readStorage=Tt,_.removeStorage=Pt,_.safeFetch=Ot,_.safeJsonParse=It,_.safeJsonStringify=Rt,_.unwrapOr=$t,_.writeStorage=At,Object.defineProperty(_,Symbol.toStringTag,{value:"Module"})})(this.NarvarShippingProtection=this.NarvarShippingProtection||{});
